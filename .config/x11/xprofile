#!/bin/sh

# xinitrc runs automatically when you run startx.
# https://wiki.archlinux.org/index.php/Xinit#xinitrc
export XDG_SESSION_TYPE=x11
export GDK_BACKEND=x11

# Start some nice programs
if [ -d /etc/X11/xinit/xinitrc.d ]; then
	for f in /etc/X11/xinit/xinitrc.d/?*.sh; do
		# shellcheck source=/dev/null
		[ -x "$f" ] && . "$f"
	done
	unset f
fi


# IBus
# https://wiki.archlinux.org/title/IBus
if command -v ibus-daemon >/dev/null 2>&1; then
    export GTK_IM_MODULE=ibus
    export QT_IM_MODULE=ibus
    export XMODIFIERS=@im=ibus
    export GLFW_IM_MODULE=ibus

    ibus-daemon -rxRd &

    setxkbmap -model pc104 \
              -layout us \
              -variant altgr-intl \
              -option terminate:ctrl_alt_bksp,caps:escape
else
    setxkbmap -model pc104 \
              -layout us,br \
              -variant altgr-intl,winkeys \
              -option terminate:ctrl_alt_bksp,caps:escape,grp:win_space_toggle
fi


# This file runs when a DM logs you into a graphical session.
# If you use startx/xinit like a Chad, this file will also be sourced.

# Set DPI. User may want to use a larger number for larger screens.
xrandr --dpi 96

# set the background with the `setbg` script
setbg &

# Autostart programs
dex --autostart --environment i3

# Use Xresources colors/settings on startup
xrdb -merge "${XDG_CONFIG_HOME:-$HOME/.config}/x11/xresources"

# Activate dbus variables
dbus-update-activation-environment --all
