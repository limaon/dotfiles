#!/usr/bin/env bash
# CPU Usage Block for i3blocks
set -euo pipefail

CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | sed "s/.*, *\([0-9.]*\)%* id.*/\1/" | awk '{print 100 - $1}')
CPU_PERCENT=${CPU_USAGE%.*}  # Remove decimal

# Color based on threshold
if (( CPU_PERCENT > 75 )); then
    COLOR="#ff0000"
elif (( CPU_PERCENT > 50 )); then
    COLOR="#ff9900"
else
    COLOR="#00ff00"
fi

echo "CPU: ${CPU_PERCENT}%"
echo "$COLOR"
